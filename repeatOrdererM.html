<head>
    <base target="_top">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script>
    window.onload = function() {    
    //console.log('window.onload ran!');
    
      google.script.run // initiates loading the sidebar I want to call
        .withFailureHandler(onFailure)
        .withSuccessHandler(closeDialog) // calls the closing function when load is successful
        .launchRepeatOrdererSidebar()
    };
    
    window.onFailure = function (error) {
        var div = document.getElementById('status');
        div.innerHTML = "ERROR: " + error.message;
    }

    window.closeDialog = function() {
      google.script.host.close();
    };
</script>

  </head>

  <body>
    <h5>This takes a moment to load. ⚙️</h5>
    <div class="progress">
        <div class="indeterminate"></div>
    </div>
    <div id="status"></div>
  </body>